<!DOCTYPE html>
<html>

<head>
    <title>Rotatable Plane + OBJ/MTL</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <!-- โหลด Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- โหลด OrbitControls -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>
    <!-- โหลด OBJ และ MTL Loader -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/loaders/MTLLoader.js"></script>

    <script>
        // Renderer
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);

        // Scene
        const scene = new THREE.Scene();

        // Camera
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(5, 5, 5);
        camera.lookAt(0, 0, 0);

        // Controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;

        // Light
        const dirLight = new THREE.DirectionalLight(0xffffff, 1);
        dirLight.position.set(5, 10, 5);
        dirLight.castShadow = true;
        scene.add(dirLight);
        scene.add(new THREE.AmbientLight(0x404040));

        // Ground
        const planeGeometry = new THREE.PlaneGeometry(20, 20);
        const planeMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff });
        const plane = new THREE.Mesh(planeGeometry, planeMaterial);
        plane.rotation.x = -Math.PI / 2;
        plane.position.y = -0.5;
        plane.receiveShadow = true;
        scene.add(plane);

        // Background texture
        const textureLoader = new THREE.TextureLoader();
        const bg = textureLoader.load("https://raw.githubusercontent.com/sirikanyaaa/final/main/road.jpg");
        scene.background = bg;

        // โหลด city1 (มี MTL)
        const mtlLoader = new THREE.MTLLoader();
        mtlLoader.load(
            'https://raw.githubusercontent.com/sirikanyaaa/final/main/city1.mtl',
            function (materials) {
                materials.preload();

                const objLoader = new THREE.OBJLoader();
                objLoader.setMaterials(materials);
                objLoader.load(
                    'https://raw.githubusercontent.com/sirikanyaaa/final/main/city1.obj',
                    function (object) {
                        object.scale.set(1, 1, 1);
                        object.position.y = 0;
                        object.traverse(function (child) {
                            if (child.isMesh) {
                                child.castShadow = true;
                                child.receiveShadow = true;
                            }
                        });
                        scene.add(object);
                    },
                    undefined,
                    function (error) {
                        console.error('Error loading city1.obj:', error);
                    }
                );
            },
            undefined,
            function (error) {
                console.error('Error loading city1.mtl:', error);
            }
        );

        // โหลด name.obj (ไม่มี MTL) → ใส่สีแดงแน่นอน
        const nameLoader = new THREE.OBJLoader();
        nameLoader.load(
            'https://raw.githubusercontent.com/sirikanyaaa/final/main/name4.obj',
            function (object) {
                object.scale.set(0.5, 0.5, 0.5);
                object.position.set(0, 2, 0);

                // Force สีแดง
                object.traverse(function (child) {
                    if (child.isMesh) {
                        child.castShadow = true;
                        child.receiveShadow = true;
                        child.material = new THREE.MeshStandardMaterial({
                            color: 0xff0000,
                            metalness: 0.3,
                            roughness: 0.4,
                            map: null,
                            vertexColors: false
                        });
                    }
                });

                scene.add(object);
            },
            undefined,
            function (error) {
                console.error('Error loading name.obj:', error);
            }
        );

       


// โหลดภาพ JPG เป็น Plane
const textureLoader2 = new THREE.TextureLoader();
textureLoader2.load('https://raw.githubusercontent.com/sirikanyaaa/final/main/IMG_3632.JPG', function(texture) {
    const geometry = new THREE.PlaneGeometry(2, 2);
    const material = new THREE.MeshBasicMaterial({ map: texture });
    const plane = new THREE.Mesh(geometry, material);
    plane.position.set(-4, 3, 0);
    scene.add(plane);
});

// Render loop (อยู่นอกทุก callback)
function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
}
animate();

// Resize listener
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});

    </script>
</body>
</html>
